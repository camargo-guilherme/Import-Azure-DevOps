<div class="container py-5 h-100">
  <div class="row d-flex justify-content-start align-items-center mt-1">
    <div class="col-12 col-md-8 col-lg-6 col-xl-5">
      <section class="project input-container">
        <label for="project">Projeto</label>
        <select
          id="project"
          class="form-select"
          aria-label="Selecione o projeto"
          [(ngModel)]="projectSelected"
          (change)="getAllWorkList()"
        >
          <option selected disabled value="">Selecione o projeto</option>
          <option *ngFor="let project of projects" [value]="project.name">
            {{ project.name }}
          </option>
        </select>
      </section>
    </div>
    <div class="mt-4 col-12 col-md-8 col-lg-6 col-xl-5">
      <button
        class="button-primary-color"
        (click)="handleDownloadXlsx()"
        [disabled]="!projectSelected"
        [matTooltip]="!projectSelected ? 'Selecione um projeto' : ''"
      >
        Gerar relat√≥rio
      </button>
    </div>
  </div>

  <div class="row mt-2">
    <div class="col-12">
      <div class="card-content">
        <table class="table table-responsive-md">
          <thead>
            <tr>
              <th></th>
              <th>Id</th>
              <th>Type</th>
              <th>Title</th>
              <th>ParentTitle</th>
              <th>AssignedTo</th>
              <th>State</th>
              <th>Tags</th>
              <th>Remaining</th>
              <th>Completed</th>
              <th>OriginalEstimate</th>
            </tr>
          </thead>
          <tbody *ngIf="workItemsList.length === 0">
            <tr class="no-register frist-td">
              <td colspan="100%">
                <span> Nenhum registro encontrado </span>
              </td>
            </tr>
          </tbody>

          <tbody>
            <tr *ngFor="let item of workItemsList">
              <td></td>
              <th>{{ item.Id }}</th>
              <th>{{ item.WorkItemType }}</th>
              <th>{{ item.Title }}</th>
              <th>{{ item.ParentTitle }}</th>
              <th>{{ item.AssignedTo }}</th>
              <th>{{ item.State }}</th>
              <th>{{ item.Tags }}</th>
              <th>{{ item.RemainingWork }}</th>
              <th>{{ item.CompletedWork }}</th>
              <th>{{ item.OriginalEstimate }}</th>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
